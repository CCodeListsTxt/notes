[toc]

lambda表达式是[纯右值]()，其类型是重载了[()]()运算符的无名[非聚合类类型]()，称为[闭包类型]()。

lambda表达式的[()]()运算符默认限定为[const]()，且无法在函数内部修改通过[值捕获]()的对象。如果在参数列表后使用[mutable]()修饰，则可修改。

如果lambda表达式用于常量表达式中，且其函数体满足[constexpr函数]()要求，其为[constexpr]()。[示例](#示例1)

## 捕获

### 捕获符

[捕获符]()用于捕获单个对象，可以直接使用[标识符]()表示『复制捕获』，也可以使用[&标识符]()表示『引用捕获』。c++14起，还可以使用[初始化器]()进行『初始化捕获』[^2]，等价使用[auto]()声明并初始化非静态数据成员。[示例](#示例2)

### 捕获列表

捕获列表是由零个或多个由[捕获符]()构成的逗号分隔列表，可以使用[默认捕获符]()开始，默认捕获符有：

* [&]()，使用引用隐式捕获被使用的自动变量。
* [=]()，使用复制隐式捕获被使用的自动变量。

使用[默认捕获符]()时，会隐式捕获lambda函数体中[ODR]()使用的对象。[示例](示例3)

# 实例

## 示例1

```cpp
auto main() -> int {
    constexpr int ci = [] {
        if consteval { return 1; }
        return 0;
    }();
    std::cout << ci << "\n"; // 1

    int i = [] {
        if consteval { return 1; }
        return 0;
    }();
    std::cout << i << "\n"; // 0

    return 0;
}
```

## 示例2

```cpp
auto main() -> int {
    int i{};
    [&ref = i] {
        ref = 1;
    }();
    std::cout << i; // 1

    return 0;
}
```

## 示例3

```cpp
auto main() -> int {
  constexpr int i = 0;

  std::cout << sizeof([=] {
    int arr[i];
  }) << "\n"; // 1

  std::cout << sizeof([=] {
    auto add = &i;
  }) << "\n"; // 4

  return 0;
}
```







[^1]:c++20开始，使用[=]()捕获时，不会自动捕获[this]()对象
[^2]:对于引用捕获，只能使用[=]()初始化器