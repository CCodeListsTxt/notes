[toc]

[new]()表达式创建并初始化拥有[动态存储期]()的对象，其基本语法为：[new 类型 初始化器『可选』]()，或[new(类型) 初始化器『可选』]()。其中，『类型』可以还是[数组类型]()、[占位类型说明符]()、或通过[类模板实参推导]()推出的类模板名[^1]。[示例](#示例1)

[new]()表达式会进行以下三步操作：

1. 通过分配函数申请存储空间。
2. 在存储空间上，构造并初始化对象或对象数组。
3. 返回指向该对象或数组首元素的纯右值指针。

## 贪心

对[new]()表达式的解析是贪心的，其会将所有可以成为声明符的部分作为声明符使用。[示例](#示例2)

## 构造规则

[new]()表达式按照以下规则进行初始化：

* 对于非数组类型：
  * 如果没有初始化器，进行[默认初始化]()。
  * 如果使用带括号的实参列表，进行[直接初始化]()。
  * 使用花括号实参列表，进行[列表初始化]()。
* 对于数组类型：
  * 如果没有初始化器，对每个元素进行[默认初始化]()。
  * 如果初始化器是空括号，对每个元素进行[值初始化]()。
  * 如果初始化器是『带括号的实参列表』或『花括号实参列表』，数组被[聚合初始化]()。

## 分配函数

[new]()表达式通过分配函数分配内存，对于非数组类型，分配函数为[operator new]()，对于数组类型，分配函数为[operator new[]]()。

在调用分配函数时，[new]()表达式会将需要分配





# 示例

## 示例1

```cpp
auto main() -> int {
    auto p1 = new auto{0};                  // 推断为int*
    auto p2 = new std::vector{1, 2, 3};     // 推断为std::vector<int>*

    return 0;
}
```

## 示例2

```cpp
auto main() -> int {
    auto p1 = new int + 1;   	// 解析为new(int) + 1
    auto p2 = new int * 1;  	// error，解析为 new(int*) 1
    auto p3 = new int * + 1;    // 解析为 new(int*) + 1

    return 0;
}
```

[^1]:当类型是[未知边界数组]()、[占位符]()、[类模板]()时，必须使用初始化器