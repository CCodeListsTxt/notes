#### 简介

* 中断通常发生在程序执行的任意时刻，以响应外部设备发出的信号。系统硬件使用中断为外部设备提供服务，软件也可以通过`INT n`指令产生中断。

  异常发生在处理器执行一条指令时，检测到出错条件时产生。

* 当检测到中断或异常时，处理器会保存当前程序状态，并执行中断或异常处理程序。执行完成后，再恢复原本程序的状态。

---

#### 向量

* 为了利于处理中断和异常，每个需要进行特殊处理的处理器定义的中断和异常都被赋予了一个标识号，称为**向量**。处理器使用向量，作为**中断描述符表[^1]**的索引，来定位中断或异常或处理程序的入口地址。
* 向量号的范围为`0~255`，其中`0~31`保留作为80x86处理器定义的中断和异常，剩余的向量号作为用户定义的中断，常用于外部IO设备。

---

#### 中断源和异常源

* 中断源：
  * 硬件产生中断。通过芯片引脚`INTR`和`NMI`接收。通过`INTR`接受的为可屏蔽中断，通过`NMI`接受的为非屏蔽中断。
  * 软件产生中断。`INT n`指令产生软件中断。
* 异常源：
  * 处理器检测的程序错误异常。
  * 软件产生异常。`INT n`指令产生软件异常。


---

#### 异常分类

* **故障[^2]**：可被纠正的异常，且纠正后程序可继续运行。处理器纠正Fault后，会再次执行产生Fault的指令。
* **陷阱[^3]**：陷阱也可被纠正，但纠正后执行的是产生Trap指令的下一条指令。
* **中止[^4]**：产生中止的程序不会再次被执行。

---

#### 中断描述符表

* **中断描述符表[^5]**最多可以存放256个8字节中断描述符。中断描述符中可以含有少于256个中断描述符，但所有空描述符的P标志都应该置为0。

  通过`IDTR`寄存器定位IDT的位置。

  ![image-20221123085038409](../../../999.asset/image-20221123085038409.png)

* IDT表中可以存放三种类型的描述符：中断门描述符，陷阱门描述符，任务门描述符。



[^1]:Interrupt Descriptor Table，IDT
[^2]:Fault
[^3]:Trap
[^4]:Abort

[^5]:Interrupt Descriptor Table，IDT

