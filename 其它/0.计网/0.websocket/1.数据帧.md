```txt
+---+---+---+---+-----------+---+-------------+------------------------+-----------------+--------------+
| F | R | R | R |           | M |             |                        |                 |              |
| I | S | S | S |  optcode  | A | payload-len |   extended-payload-len |   masking-key   | payload-data |
| N | V | V | V | (4 bits)  | S |  (7 bits)   |	     (2 or 8 bytes)    |  (0 or 4 bytes) |              |
|   | 1 | 2 | 3 |           | K |             |                        |                 |              | 
+---+---+---+---+-----------+---+-------------+------------------------+-----------------+--------------+
```

*   `FIN`表示当前片段是否是本次消息的最后一个片段（一次消息可能分多个片段发送）。

*   `RSV1`、`RSV2`和`RSV3`表示是否开启某个拓展。

*   `optcode`是对有效荷载的解释：

    *   `0x0`表示一个持续帧。

    *   `0x1`表示一个文本帧（总是utf8编码）。

    *   `0x2`表示一个二进制帧。

        >   第一帧的数据可能标记为文本帧或二进制帧，后续同一消息的数据帧就会被标记为持续帧。

    *   `0x3 - 0x7`预留。

    *   `0x8`表示关闭连接。

    *   `0x9`表示ping包。

    *   `0xA`表示pong包。

    *   `0xB - 0xF`预留。

*   `mask`表示是否添加掩码数据。如果添加掩码数据，那么所有有效荷载都会与4字节的`masking-key`进行掩码运算。

*   `payload-len`，有效荷载长度。

    *   如果`payload-len`在0-125范围，则直接表示有效荷载长度。
    *   如果`payload-len`是126，那么后续的2字节`extended-payload-len`表示有效荷载长度。
    *   如果`payload-len`是127，那么后续的64字节`extended-payload-len`表示有效荷载长度。

*   `masking-key`，4字节掩码。

    >   其编码的代码类似如下：
    >
    >   ```cpp
    >   for(int i = 0;i < data.length; ++i)
    >   	data[i] = data[i] ^ mask[i % 4];
    >   ```
    >
    >   则解码的代码应该如下：
    >
    >   ```cpp
    >   for(int i = 0;i < data.lenght; ++i)
    >       data[i] = mask[i % 4] ^ data[i];
    >   ```

*   `payload-data`，有效荷载由拓展数据和应用数据构成。